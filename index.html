<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Media Viewer</title>
    <style>
        body, html { margin: 0; padding: 0; height: 100%; width: 100%; background: #000; overflow: hidden; font-family: sans-serif; }
        #app { position: relative; width: 100%; height: 100%; display: none; overflow: hidden; }
        
        .container {
            position: absolute; width: 100%; height: 100%;
            display: flex; justify-content: center; align-items: center;
            transition: transform 0.4s cubic-bezier(0.45, 0, 0.55, 1);
        }

        .content { max-height: 100vh; max-width: 100vw; object-fit: contain; }

        /* Состояния анимации */
        .slide-up { transform: translateY(-100%); }
        .slide-down { transform: translateY(100%); }

        /* Подсказка внизу */
        .hint {
            position: absolute; bottom: 20px; width: 100%; text-align: center;
            color: rgba(255, 255, 255, 0.2); /* Очень бледный текст */
            font-size: 11px; text-transform: uppercase; letter-spacing: 2px;
            pointer-events: none; z-index: 10;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 0.2; }
            50% { opacity: 0.5; }
            100% { opacity: 0.2; }
        }

        #age-gate {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #0a0a0a; z-index: 1000; display: flex; flex-direction: column;
            justify-content: center; align-items: center; text-align: center;
        }
        #age-gate p { font-size: 13px; margin-bottom: 20px; color: #333; letter-spacing: 0.5px; }
        #enter-btn { 
            background: transparent; border: 1px solid #222; color: #444; padding: 10px 25px; 
            border-radius: 2px; font-size: 12px; cursor: pointer; text-transform: uppercase;
        }
    </style>
</head>
<body>

    <div id="age-gate">
        <p>CONFIRM AGE TO PROCEED</p>
        <button id="enter-btn" onclick="verifyAge()">Enter</button>
    </div>

    <div id="app">
        <div id="main-container" class="container">
            <video id="v" class="content" playsinline loop muted></video>
            <img id="i" class="content">
        </div>
        <div class="hint">Swipe up to skip</div>
    </div>

    <script>
        const USER = 'Tailznic';
        const REPO = 'tailznic.github.io';
        const FOLDER = 'media';
        let files = [], queue = [];
        let touchStartY = 0;
        let isAnimating = false;

        const container = document.getElementById('main-container');
        const v = document.getElementById('v'), i = document.getElementById('i');

        function verifyAge() {
            document.getElementById('age-gate').style.display = 'none';
            document.getElementById('app').style.display = 'block';
            init();
        }

        async function init() {
            try {
                const res = await fetch(`https://api.github.com/repos/${USER}/${REPO}/contents/${FOLDER}`);
                const data = await res.json();
                files = data.filter(f => f.type === 'file').map(f => f.download_url);
                queue = [...files].sort(() => Math.random() - 0.5);
                loadContent(queue.pop());
            } catch (e) { console.log("error"); }
        }

        function loadContent(url) {
            if (!url) return;
            const ext = url.split('.').pop().toLowerCase();
            
            v.style.display = i.style.display = 'none';
            v.pause(); v.src = ""; i.src = "";

            if (['mp4', 'webm', 'mov'].includes(ext)) {
                v.src = url; 
                v.style.display = 'block'; 
                v.onloadeddata = () => {
                    v.play().catch(() => {});
                    finishTransition();
                };
            } else {
                i.src = url; 
                i.style.display = 'block';
                i.onload = () => finishTransition();
            }
        }

        function triggerSwipe() {
            if (isAnimating) return;
            isAnimating = true;

            container.classList.add('slide-up');

            setTimeout(() => {
                if (queue.length === 0) queue = [...files].sort(() => Math.random() - 0.5);
                container.style.transition = 'none';
                container.classList.remove('slide-up');
                container.classList.add('slide-down');
                loadContent(queue.pop());
            }, 400);
        }

        function finishTransition() {
            setTimeout(() => {
                container.style.transition = 'transform 0.4s cubic-bezier(0.45, 0, 0.55, 1)';
                container.classList.remove('slide-down');
                isAnimating = false;
            }, 50);
        }

        v.onclick = (e) => e.preventDefault();
        i.onclick = (e) => e.preventDefault();

        window.addEventListener('touchstart', e => touchStartY = e.changedTouches[0].screenY);
        window.addEventListener('touchend', e => {
            let touchEndY = e.changedTouches[0].screenY;
            if (Math.abs(touchStartY - touchEndY) > 40) triggerSwipe();
        });

        window.addEventListener('wheel', e => {
            if (Math.abs(e.deltaY) > 10) triggerSwipe();
        });
    </script>
</body>
</html>
